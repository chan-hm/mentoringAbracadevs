<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Admin: View all account info</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script type="text/javascript">

        var tableRowLength;

        // this function display all account info
        function loadAccounts() {
            var webMethod = "AccountServices.asmx/GetAllAccountInfo";
            var parameters = "{}";

            //jQuery ajax method
            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (array) {
                    console.log("function started");
                    console.log(array);

                    var infoArray = array.d;
                    var tableRowNumber = 1;
                    console.log(infoArray);

                    for (var i = 0; i < infoArray.length; i++) {

                        var row = document.getElementById("infoTableId").insertRow(tableRowNumber);
                        var cell0 = row.insertCell(0);
                        var cell1 = row.insertCell(1);
                        var cell2 = row.insertCell(2);
                        var cell3 = row.insertCell(3);
                        var cell4 = row.insertCell(4);
                        var cell5 = row.insertCell(5);
                        var cell6 = row.insertCell(6);
                        var cell7 = row.insertCell(7);

                        cell0.innerHTML = infoArray[i]["userID"];
                        cell1.innerHTML = infoArray[i]["firstName"];
                        cell2.innerHTML = infoArray[i]["lastName"];
                        cell3.innerHTML = infoArray[i]["employeeID"];
                        cell4.innerHTML = infoArray[i]["email"];
                        cell5.innerHTML = infoArray[i]["department"];
                        cell6.innerHTML = infoArray[i]["position"];
                        cell7.innerHTML = infoArray[i]["status"];

                        tableRowNumber += 1;
                    }
                    //tableRowLength = document.getElementById("infoTableId").rows.length;

                    function loadMentors() {
                        var webMethod = "AccountServices.asmx/GetMentors";
                        var parameters = "{}";

                        //jQuery ajax method
                        $.ajax({
                            type: "POST",
                            url: webMethod,
                            data: parameters,
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            success: function (array) {
                                console.log("function started");
                                console.log(array);

                                var mentorArray = array.d;
                                var row;
                                var rowNumber = 1;
                                var cell;
                                var options;
                                var mentors;
                          

                                console.log(mentorArray);

                                // testing 1
                                
                                for (var i = 0; i < infoArray.length; i++) {
                                    row = document.getElementById("infoTableId").rows[rowNumber];
                                    cell = row.insertCell(-1);
                                    cell.innerHTML = "<select id='mentorsId'>";

                                    for (var j = 0; j < mentorArray.length; j++) {
                                        options = mentorArray[j]["firstName"] + " " + mentorArray[j]["lastName"];

                                        mentors += "<option>" + options + "</option>";

                                        console.log(mentors);
                                    } 
                                    rowNumber += 1;
                                }

                                $("#mentorsId").append(mentors);
                                

                                // testing 2
                                /*
                                for (var i = 0; i < infoArray.length; i++) {
                                    row = document.getElementById("infoTableId").rows[rowNumber];
                                    cell = row.insertCell(-1);
                                    cell.innerHTML = "<select id='mentorsId'>"; 
                                    rowNumber += 1;
                                }

                                for (var j = 0; j < mentorArray.length; j++) {
                                    options = mentorArray[j]["firstName"] + " " + mentorArray[j]["lastName"];

                                    mentors += "<option>" + options + "</option>";
                                    console.log(mentors);

                                   // $("#mentorsId").append("<option>" + options + "</option>");
                                }

                                $("#mentorsId").append(mentors);*/
                            }
                        });
                    }
                    loadMentors();
                }
            });
     }

    </script>

    <style>
        #infoTableId th, #infoTableId td {
            padding-left: 15px;
            padding-right: 15px;
        }

        #infoTableId {
            border: 1px solid black;
            background-color: lightblue;
        }
    </style>

</head>

<body onload="loadAccounts()">
    <!--loadAccounts(), loadMentors()-->
    <div class="accountInfo">
        <h1>User Information</h1>
        <hr />

        <table class="InfoTable" id="infoTableId">
            <tr>
                <td>User ID</td>
                <td>First Name</td>
                <td>Last Name</td>
                <td>Employee ID</td>
                <td>Email Address</td>
                <td>Department</td>
                <td>Position</td>
                <td>Status</td>
                <td>Mentor</td>
            </tr>
        </table>
    </div>

</body>
</html>